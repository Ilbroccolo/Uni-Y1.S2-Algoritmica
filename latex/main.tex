\documentclass[a4paper,11pt]{article}

% ===================================================================
% NUOVO STILE: "La Bibbia" (Light Theme + Orange + JS Aesthetics)
% ===================================================================

% --- Pacchetti Fondamentali ---
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[italian]{babel}
\usepackage{geometry}
\geometry{top=2.5cm, bottom=2.5cm, left=2.5cm, right=2.5cm}

% --- Font Moderni ---
\usepackage{lmodern}
\usepackage{helvet}
\renewcommand{\familydefault}{\sfdefault} % Usa sans-serif per tutto il documento

% --- Colori e Grafica ---
\usepackage{xcolor}
\usepackage{tikz}
\usepackage{amssymb}
\usepackage{amsmath} % Aggiunto per supporto matematico
\usepackage{amsthm}  % Aggiunto per proof e teoremi

\usepackage{graphicx} % Aggiunto per immagini
\usepackage{wrapfig}  % Aggiunto per compatibilità
\usepackage{caption} 
\usepackage{subcaption}

% --- Pacchetti Utility (Compatibilità Vecchio Testo) ---
\usepackage{multicol}
\usepackage{soul}
\usepackage{enumitem}
\usepackage{lipsum}
\usepackage{mwe}
\usepackage{multirow}
\usetikzlibrary{shapes, arrows.meta, positioning, chains, fit, calc, matrix, trees, backgrounds, decorations.pathmorphing, decorations.pathreplacing, snakes}

% --- Definizione Colori (Custom 5-Color Palette)
\definecolor{paletteIndigo}{HTML}{2D1E64}   % Dark Backgrounds
\definecolor{paletteRegalia}{HTML}{592F83}  % Primary Brand / Headers
\definecolor{paletteLenurple}{HTML}{B795D7} % Secondary Accent (Light Purple)
\definecolor{paletteLavender}{HTML}{EADCFA} % Box Backgrounds
\definecolor{paletteWenge}{HTML}{69525D}    % Text / Details

% --- Mapping Colors to Layout ---
\colorlet{mainOrange}{paletteRegalia}       % Sections / Main Theme
\colorlet{jsYellow}{paletteLenurple}        % Accents (Replacing Gold/Yellow)
\colorlet{jsDark}{paletteIndigo}            % Sidebar / Dark Elements
\colorlet{codeBg}{white}          % Box Backgrounds (White as requested)
\colorlet{niceBlue}{paletteRegalia}         % Concept Box Frames
\colorlet{textGray}{paletteWenge}           % Meta Text
\colorlet{tsBlue}{paletteRegalia}           % Misc Blue elements

\definecolor{codeBlue}{HTML}{0000FF}
\definecolor{codePink}{HTML}{800080}
\definecolor{codeGreen}{HTML}{008000}
% --- Colori Legacy (Compatibilità) ---
\definecolor{codegray}{named}{white}
\definecolor{commentpurple}{rgb}{0.5,0,0.5}
\definecolor{stringred}{rgb}{0.8,0,0}

% --- COMANDO COPERTINA (Pure TikZ - Left Aligned) ---
\newcommand{\customcover}[2]{
    \begin{titlepage}
    \thispagestyle{empty}
    \begin{tikzpicture}[remember picture, overlay]
        
        % 1. Sfondo Laterale (Indigo)
        \fill[jsDark] (current page.north west) rectangle ($(current page.south west) + (4cm,0)$);
        
        % 2. Linea Accento (Lenurple)
        \draw[jsYellow, line width=4pt] ($(current page.north west) + (4.2cm,-2cm)$) -- ($(current page.south west) + (4.2cm,2cm)$);
        
        % 3. Contenuto Testuale (ALLINEATO A SINISTRA)
        \node[anchor=north west, inner sep=0, text width=14cm, align=flush left] at ($(current page.north west) + (6cm,-5cm)$) {
            
                {\fontsize{18}{22}\selectfont \textcolor{textGray}{Università di Pisa}}\\[0.2cm]
                {\fontsize{16}{20}\selectfont \textcolor{textGray}{Corso di Laurea in Informatica}}\\[2cm]
                
                {\fontsize{60}{70}\selectfont \textbf{\textcolor{jsDark}{LA BIBBIA Di }}}\\[0.5cm]
                %{\fontsize{35}{45}\selectfont \textbf{\textcolor{black}{DI}}}\\[0.2cm]
                {\fontsize{35}{45}\selectfont \textbf{\textcolor{black}{PROGRAMMAZIONE}}}\\[0.2cm]
                {\fontsize{35}{45}\selectfont \textbf{\textcolor{black}{ED ALGORITMICA}}}\\[1.5cm]
                
                % Linea divisoria (Sinistra)
                \textcolor{jsYellow}{\rule{8cm}{4pt}}\\[1cm]
                
                {\Large \textbf{#1}}\\[0.2cm]
                {\large \textit{#2}}\\[1.5cm]
                
                {\large Docenti titolari:}\\[0.2cm]
                {\Large \textbf{[Nome Docente]}}\\[2cm]
                
                \textbf{\large Autore del riassunto:}\\
                {\large Joseph Zucchelli}\\[2cm]
                
                \vfill
                {\large \textbf{Anno Accademico 2024 - 2025}}
            
        };
        
        % Badge (Opzionale)
        \node[anchor=south east] at ($(current page.south east) + (-2cm, 2cm)$) {
            \tikz\draw[fill=jsYellow, draw=none] (0,0) rectangle (2,2) node[midway, black, font=\bfseries\huge] {P\&A};
        };

    \end{tikzpicture}
    \end{titlepage}
    \clearpage
}

% --- Box per il Codice e Note (tcolorbox) ---
\usepackage[most]{tcolorbox}
\usepackage{listings}
\usepackage{titlesec} % Per colorare i titoli
\usepackage[pdfusetitle, bookmarksopen=true, bookmarksnumbered=true]{hyperref}
\hypersetup{
    colorlinks=true,
    linkcolor=mainOrange,
    citecolor=niceBlue,
    urlcolor=niceBlue,
    linktoc=all
}


% Setup Titoli Arancioni
\titleformat{\section}
{\color{mainOrange}\normalfont\Large\bfseries}
{\color{mainOrange}\thesection}{1em}{}[\color{mainOrange}\hrule height 1pt]

\titleformat{\subsection}
{\color{mainOrange}\normalfont\large\bfseries}
{\color{mainOrange}\thesubsection}{1em}{}

% Stile per il codice JS
\lstdefinelanguage{JavaScript}{
  keywords={typeof, new, true, false, catch, function, return, null, catch, switch, var, if, in, while, do, else, case, break, const, let},
  keywordstyle=\color{green!60!black}\bfseries,
  ndkeywords={class, export, boolean, throw, implements, import, this, console, log, prompt, alert},
  ndkeywordstyle=\color{green!60!black}\bfseries,
  identifierstyle=\color{black}, 
  sensitive=false,
  comment=[l]{//},
  morecomment=[s]{/*}{*/},
  commentstyle=\color{teal}\itshape,
  stringstyle=\color{red!60!black}\ttfamily,
  morestring=[b]',
  morestring=[b]"
}

% Box Codice
\newtcblisting{jsbox}[1][]{
  colback=codeBg,
  colframe=gray!50,
  listing only,
  listing options={
    language=JavaScript,
    basicstyle=\ttfamily\small, % Testo nero di default
    numbers=left,
    numberstyle=\tiny\color{gray},
    breaklines=true,
    columns=fullflexible
  },
  title={\textbf{Codice}},
  coltitle=black,
  fonttitle=\bfseries\ttfamily,
  enhanced,
  attach boxed title to top right={yshift=-3mm, xshift=-3mm},
  boxed title style={colback=jsYellow},
  #1
}

% Box Funzioni Viola
\newtcblisting{funcbox}[1][]{
  colback=violet!5,        % Sfondo Viola chiarissimo
  colframe=violet!75,      % Bordo Viola
  listing only,
  listing options={
    language=JavaScript,
    basicstyle=\ttfamily\small,
    numbers=left,
    numberstyle=\tiny\color{gray},
    breaklines=true,
    columns=fullflexible
  },
  title={\textbf{Funzione: #1}},
  coltitle=white,
  fonttitle=\bfseries\ttfamily,
  enhanced,
  attach boxed title to top left={yshift=-3mm, xshift=3mm},
  boxed title style={colback=violet}, 
  drop shadow,
  #1
}

% Box Concetti/Note
\newtcolorbox{concept}[1]{
  colback=niceBlue!5,
  colframe=niceBlue,
  title={#1},
  fonttitle=\bfseries,
  sharp corners=downhill,
  enhanced,
  drop shadow
}

% --- COMPATIBILITÀ CON VECCHI AMBIENTI ---
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{etoolbox}

% 1. Box per Algoritmi (Replica lo stile JSBox ma per pseudocodice)
\newtcolorbox{algobox}{
  colback=codeBg,
  colframe=mainOrange,
  title={\textbf{Algoritmo}},
  coltitle=white,
  fonttitle=\bfseries\ttfamily,
  enhanced,
  attach boxed title to top left={yshift=-3mm, xshift=3mm},
  boxed title style={colback=mainOrange},
  drop shadow
}
% --- Global Listings Style (Matches User Image) ---
\lstset{
  basicstyle=\ttfamily\small,
  keywordstyle=\color{green!60!black}\bfseries,
  commentstyle=\color{teal}\itshape,
  stringstyle=\color{red!60!black}\ttfamily,
  numberstyle=\tiny\color{gray},
  breaklines=true,
  tabsize=2,
  backgroundcolor=\color{codeBg}
}

% --- Customizing Algorithmic Colors ---
\algrenewcommand\algorithmicprocedure{\textbf{\textcolor{green!60!black}{Procedure}}}
\algrenewcommand\algorithmicfunction{\textbf{\textcolor{green!60!black}{Function}}}
\algrenewcommand\algorithmicwhile{\textbf{\textcolor{green!60!black}{While}}}
\algrenewcommand\algorithmicfor{\textbf{\textcolor{green!60!black}{For}}}
\algrenewcommand\algorithmicif{\textbf{\textcolor{green!60!black}{If}}}
\algrenewcommand\algorithmicelse{\textbf{\textcolor{green!60!black}{Else}}}
\algrenewcommand\algorithmicreturn{\textbf{\textcolor{green!60!black}{Return}}}
\algrenewcommand\algorithmicstate{\State} % State remains default (usually black)

\BeforeBeginEnvironment{algorithmic}{\begin{algobox}}
\AfterEndEnvironment{algorithmic}{\end{algobox}}

% --- Explanation Box Style ---
\newtcolorbox{explanation}[1]{
    colback=yellow!10,
    colframe=orange!80!black,
    coltitle=black,
    fonttitle=\bfseries\sffamily,
    title={#1},
    arc=2mm,
    left=4mm, right=4mm, top=4mm, bottom=4mm,
    sharp corners=south,
    boxrule=1pt,
    width=\linewidth
}

% 3. Box per Codice Generico (codebox)
\newtcolorbox{codebox}[1]{
    colback=codeBg,
    colframe=paletteIndigo,
    title={\textbf{#1}},
    coltitle=white,
    fonttitle=\bfseries\ttfamily,
    enhanced,
    attach boxed title to top left={yshift=-3mm, xshift=3mm},
    boxed title style={colback=paletteIndigo},
    drop shadow
}

% 2. Mappatura Teoremi/Definizioni al nuovo stile 'concept'
% Definiamo nuovi ambienti che wrappano 'concept'
% Se i file inclusi usano \begin{definition} ... \end{definition}, useranno questo stile.

\newenvironment{definition}[1][Definizione]
  {\begin{concept}{#1}}
  {\end{concept}}

\newenvironment{theorem}[1][Teorema]
  {\begin{concept}{#1}}
  {\end{concept}}

\newenvironment{example}[1][Esempio]
  {\begin{concept}{#1}}
  {\end{concept}}

\newenvironment{observation}[1][Osservazione]
  {\begin{concept}{#1}}
  {\end{concept}}
  
\newenvironment{property}[1][Proprietà]
  {\begin{concept}{#1}}
  {\end{concept}}

\newenvironment{intuition}[1][Intuizione]
  {\begin{concept}{#1}}
  {\end{concept}}

\newenvironment{analysis}[1][Analisi]
  {\begin{concept}{#1}}
  {\end{concept}}

\newenvironment{note}[1][Nota]
  {\begin{concept}{#1}}
  {\end{concept}}

% Mappatura Dimostrazione (usa standard proof di amsthm o custom box)
\newenvironment{dimostrazione}
  {\begin{proof}[Dimostrazione]}
  {\end{proof}}

% Comandi di formattazione extra
\newcommand{\R}{\mathbb{R}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\Z}{\mathbb{Z}}


% ===================================================================
% INIZIO DOCUMENTO
% ===================================================================
\begin{document}

% Copertina Personalizzata
\customcover{Appunti Completi}{Informatica - Università di Pisa}

\tableofcontents
\newpage

% ---- Inclusione Capitoli ----
\newpage \input{lezioni/Lezione1}
\newpage \input{extra/precisazione_00}
\newpage \input{lezioni/Lezione2}
% \input{lezioni/Lezione3} (Removed duplicate)
\newpage \input{lezioni/Lezione4}
\newpage \input{lezioni/Lezione5}
\newpage \input{lezioni/Lezione6}
\newpage \input{lezioni/Lezione7}
\newpage \input{lezioni/Lezione8}
\newpage \input{extra/precisazione_01}
\newpage \input{lezioni/Lezione9}
\newpage \input{extra/approfondimento_02}
\newpage \input{lezioni/Lezione10}
\newpage \input{lezioni/Lezione11}
% \input{lezioni/Lezione12}
\newpage \input{lezioni/Lezione13grossi}
\newpage \input{lezioni/Lezione14}
\newpage \input{lezioni/Lezione15}
\newpage \input{lezioni/Lezione16}
\newpage \input{lezioni/Lezione17}
\newpage \input{lezioni/Lezione18}
\newpage \input{lezioni/Lezione19}

\newpage
\part{Errori Comuni e Note}
\input{extra/log_errori}

\end{document}
